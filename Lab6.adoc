:figure-caption: Рисунок

= Лабораторная №6
:toc:
:toc-title: ОГЛАВЛЕНИЕ:

== Задание

* Написать программу, которая по нажатию на User Button зажигает все (4) светодиоды, по следующему нажатию тушит все (4) светодиоды. 

** Нужно настроить правильно порты, на Вход,  Medium Speed, без подтяжек, подтяжка на кнопку есть внешняя, поэтому внутренняя не нужна.

== Работа с программой

. Подключаем необходимые шины. 
. Назначаем порты диодов на Выход на скорости "Medium Speed", а кнопку на Вход той же скорости.

Код подключения:

[source, c++]
RCC::APB2ENR::SYSCFGEN::Enable::Set();
RCC::AHB1ENR::GPIOAEN::Enable::Set(); // Подключение к шине
RCC::AHB1ENR::GPIOCEN::Enable::Set(); // Подключение к шине
GPIOA::OSPEEDR::OSPEEDR5::MediumSpeed::Set();
GPIOA::MODER::MODER5::Output::Set();
GPIOC::OSPEEDR::OSPEEDR5::MediumSpeed::Set();
GPIOC::MODER::MODER5::Output::Set();
GPIOC::OSPEEDR::OSPEEDR9::MediumSpeed::Set();
GPIOC::MODER::MODER9::Output::Set();
GPIOC::OSPEEDR::OSPEEDR8::MediumSpeed::Set();
GPIOC::MODER::MODER8::Output::Set();
GPIOC::OSPEEDR::OSPEEDR13::MediumSpeed::Set();
GPIOC::MODER::MODER13::Input::Set();

Код программы, которая при нажатии кнопки будет включать или выключать диоды (на кнопке есть внешнаяя подтяжка на уровень "Hight", при нажатии на неё уровень меняется на "Low"), представлен ниже.

[source, c++]
int main()
{
static  uint8_t flag = 0;
for (;;)
{
if(GPIOC::IDR::IDR13::Low::IsSet() && flag==0)
{
GPIOA::ODR::ODR5::High::Set();
GPIOC::ODR::ODR5::High::Set();
GPIOC::ODR::ODR8::High::Set();
GPIOC::ODR::ODR9::High::Set();
flag =1;
continue;
}
if (GPIOC::IDR::IDR13::Low::IsSet() && flag==1)
{
GPIOA::ODR::ODR5::Low::Set();
GPIOC::ODR::ODR5::Low::Set();
GPIOC::ODR::ODR8::Low::Set();
GPIOC::ODR::ODR9::Low::Set();
flag =0;
continue;
}
}
return 0;
}

== Результат раоты программы:

image::1.gif[]
